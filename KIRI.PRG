IF ! FILE("KIR.DBF")
	CREATE RADNA
	STORE "RBkir     N 4 " TO POLJE1
	STORE "datkkir   D8  " TO POLJE2
	STORE "brrackir  C8  " TO POLJE3
	STORE "dATrackir D8  " TO POLJE4
	STORE "kupkir    N 6 " TO POLJE5
	STORE "pibjmbgkirC13 " TO POLJE6
	STORE "uknakkir  N122" TO POLJE7
	STORE "osaod     N122" TO POLJE8
	STORE "obezod    N122" TO POLJE9
	STORE "osaodi    N122" TO POLJE10
	STORE "obezodi   N122" TO POLJE11
	STORE "osn18     N122" TO POLJE12
	STORE "izn18     N122" TO POLJE13
	STORE "osn8      N122" TO POLJE14
	STORE "izn8      N122" TO POLJE15
	STORE "uksib     N122" TO POLJE16
	STORE "uks       N122" TO POLJE17
	FOR I = 1 TO 17
		IF I < 10
			STORE  STR(I,1) TO BROJ
		ELSE
			STORE  STR(I,2) TO BROJ
		ENDIF
		P1 = "POLJE" + BROJ
		APPEND BLANK
		REPLACE FIELD_NAME WITH SUBSTR(&P1,1,10)
		REPLACE FIELD_TYPE WITH SUBSTR(&P1,11,1)
		REPLACE FIELD_LEN WITH Val(SUBSTR(&P1,12,2))
		REPLACE FIELD_DEC WITH Val(SUBSTR(&P1,14,1))
	NEXT I
	CREATE KIR FROM RADNA
	INDEX ON DTOS(DATKKIR) TO KIRDK
	INDEX ON BRRACKIR TO KIRBRAC
	USE
	ERASE RADNA.DBF
ENDIF

SELECT 0
USE KIR INDEX KIRBRAC,KIRDK

DO WHILE .T.

	DN = " "
	WRBkir    = Val("0000")
	Wdatkkir  = Date()
	wbrrack   = Space(10)	&& BROJ RACUNA PO NJEMU SE MENJA
	WdATrack  = Date()
	Wkupkir   = Val("000000")
	wpib      = Space(13)
	wuknakkir = Val("000000000.00")
	wosaod    = Val("000000000.00")
	wobezod   = Val("000000000.00")
	wosaodi   = Val("000000000.00")
	wobezodi  = Val("000000000.00")
	wosn18    = Val("000000000.00")
	wizn18    = Val("000000000.00")
	wosn8     = Val("000000000.00")
	wizn8     = Val("000000000.00")
	wuksib    = Val("000000000.00")
	wuks      = Val("000000000.00")
	
	CLEAR SCREEN
	@ 0,0 TO 24,79 DOUBLE
	@ 1,1 SAY Centriraj("IZMENA PODATAKA U KNJIZI IZLAZNIH RACUNA", 78)

	@ 5,5 SAY "BROJ RACUNA                  " GET WBRRACK VALID(wbrrack # Space(10))
	READ

	IF Lastkey() = 27
   	EXIT
	ENDIF

	SEEK wbrrack
	IF Found()
	   WRBkir    = RBKIR
	   Wdatkkir  = DATKKIR
	   wbrrack   = BRRACKIR
	   WdATrack  = DATRACKIR
	   Wkupkir   = KUPKIR
	   wpib      = PIBJMBGKIR
	   wuknakkir = UKNAKKIR
	   wosaod    = OSAOD
	   wobezod   = OBEZOD
	   wosaodi   = OSAODI
	   wobezodi  = OBEZODI
	   wosn18    = OSN18
	   wizn18    = IZN18
	   wosn8     = OSN8
	   wizn8     = IZN8
	   wuksib    = UKSIB
	   wuks      = UKS
	ELSE
   	MessageBox("Ne postoji taj broj racuna!")
   	LOOP
	ENDIF

	CLEAR SCREEN
	@ 0,0 TO 24,79 DOUBLE
	@ 1,1 SAY Centriraj("IZMENA PODATAKA U KNJIZI IZLAZNIH RACUNA", 78)

	@ 2 ,5 SAY "REDNI BROJ                   " GET WRBKIR PICTURE "9999"
	@ 3 ,5 SAY "DATUM KNJIZENJA              " GET WDATKKIR
	@ 4 ,5 SAY "BROJ RACUNA                  " GET WBRRACK
	@ 5 ,5 SAY "DATUM IZDAVANJA RACUNA (DOK.)" GET WDATRACK
	@ 6 ,5 SAY "KUPAC (NAZIV I SEDISTE)      " GET WKUPKIR PICTURE "999999"
	@ 7 ,5 SAY "PIB ili JMBG                 " GET WPIB
	@ 8 ,5 SAY "UKUPNA NAKNADA SA PDV        " GET WUKNAKKIR PICTURE "999999999.99"
	@ 9 ,5 SAY "OSLOBODJEN PROMETA SA PRAVOM "
	@ 10,5 SAY "ODBITKA PRED.POREZA (24. T.7)" GET WOSAOD PICTURE "999999999.99"
	@ 12,5 SAY "OSLOBODJEN PROMETA BEZ PRAVA "
	@ 13,5 SAY "ODBITKA PRED.POREZA (23. T.9)" GET WOBEZOD PICTURE "999999999.99"
	@ 15,5 SAY "INOS. POS.PRAVO. NA PRED.PDV " GET WOSAODI PICTURE "999999999.99"
	@ 16,5 SAY "INOS.NE PRAVO NA PREDHOD.PDV " GET WOBEZODI PICTURE "999999999.99"
	@ 17,5 SAY "OSNOVICA PO STOPI OD 18 %    " GET WOSN18 PICTURE "999999999.99"
	@ 18,5 SAY "IZNOS PDV PO STOPI OD 18 %   " GET WIZN18 PICTURE "999999999.99"
	@ 19,5 SAY "OSNOVICA PO STOPI OD  8 %    " GET WOSN8 PICTURE "999999999.99"
	@ 20,5 SAY "IZNOS PDV PO STOPI OD  8 %   " GET WIZN8 PICTURE "999999999.99"
	@ 21,5 SAY "UK.PROMET DOB.I US.SA P. I BP" GET WUKSIB PICTURE "999999999.99"
	@ 22,5 SAY "UK.PROMET SA PRAVOM NA ODBIT." GET WUKS PICTURE "999999999.99"
	
	READ
	
	IF Lastkey() = 27
		EXIT
	ENDIF

	wuksib = Round(wosaod + wobezod + wosaodi + wobezodi + wosn18 + wosn8,2)
	wuks   = Round(wosaod + wosaodi + wosn18 + wosn8,2)

	@ 21,35 SAY WUKSIB PICTURE "999999999.99"
	@ 22,35 SAY WUKS PICTURE "999999999.99"
	 	
	@ 23,24 SAY "Upis (D/N)? " GET DN PICTURE "!" VALID(DN $ "DN")
	READ
	
	IF Lastkey() = 27
   	EXIT
	ENDIF

	IF DN = "N"
   	LOOP
	ENDIF

	REPLACE RBKIR       WITH WRBkir
	REPLACE DATKKIR     WITH Wdatkkir
	REPLACE BRRACKIR    WITH wbrrack
	REPLACE DATRACKIR   WITH WdATrack
	REPLACE KUPKIR      WITH Wkupkir
	REPLACE PIBJMBGKIR  WITH wpib
	REPLACE UKNAKKIR    WITH wuknakkir
	REPLACE OSAOD       WITH  Wosaod
	REPLACE OBEZOD      WITH Wobezod
	REPLACE OSAODI      WITH wosaodi
	REPLACE OBEZODI     WITH Wobezodi
	REPLACE OSN18       WITH wosn18
	REPLACE IZN18       WITH wizn18
	REPLACE OSN8        WITH wosn8
	REPLACE IZN8        WITH wizn8
	REPLACE UKSIB       WITH wuksib
	REPLACE UKS         WITH wuks

ENDDO

CLOSE DATABASES

RETURN
