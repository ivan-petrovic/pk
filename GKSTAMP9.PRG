* - nije pregledano - *
CLEAR SCREEN
SET DATE GERMAN

SELECT 0
USE RASHODN INDEX RASHINDN

DO WHILE .T.
GO TOP
ESCKEY()
DAT1 = DATE()
DAT2 = DATE()
RED = 0
II = 0
STR = 0
BRSTAVKE = 0
sk = " "
WRPV = VAL("000000000000.00")
WRPN = VAL("000000000000.00")
WRPBEZ = VAL("000000000000.00")
WRPBEZ06 = VAL("000000000000.00")
WRPBEZ2 = VAL("000000000000.00")
WRPBEZ4 = VAL("000000000000.00")
WRUSP = VAL("000000000000.00")
WRUSBEZP = VAL("000000000000.00")
WRSVEP = VAL("000000000000.00")
@ 10,10 SAY "KNJIGA PRIHODA OD DATUMA" GET DAT1 VALID !Empty(DAT1)
@ 10,48 SAY "DO DATUMA" GET DAT2 VALID !Empty(DAT2)
@ 12,10 SAY "STR  ILI KOMISION NISTA ZAJEDNO    S/K  " GET SK
READ
*
IF Lastkey() = 27
CLEAR SCREEN
USE
RETURN
ENDIF
IF SK = "S"
   II = 1
ENDIF
IF SK = "S"
   SET FILTER TO RSK = 0
   GO TOP
ENDIF
IF SK = "K"
   SET FILTER TO RSK = 1
   GO TOP
ENDIF
IF DAT1 > DAT2
    @ 18,10 SAY "POCETNI DATUM VECI OD KRAJNJEG"
    WAIT " "
    CLEAR SCREEN
    LOOP
ENDIF
SET DEVICE TO PRINTER
SET PRINTER TO Lpt1
SET PRINT ON
SET CONSOLE OFF
SET PROCEDURE TO GLAVA
DO GLAVA
DO WHILE .T.                        
   IF Eof()
      EXIT
   ENDIF

   IF DTOS(rDK) >= DTOS(DAT1) .AND. DTOS(rDK) <= DTOS(DAT2)
*   IF SK = " "
      @ RED,0 SAY RRB PICTURE "9999"
      @ RED,5 SAY RDK
      @ RED,14 SAY RBR
      @ RED,25 SAY SUBSTR(ROPIS,1,8)
      @ RED,34 SAY RPV PICTURE "9999999.99"
      @ RED,45 SAY RPN PICTURE "9999999.99"
      @ RED,56 SAY RPBEZ PICTURE "9999999.99"
      @ RED,67 SAY RPBEZ06 PICTURE "9999999.99"
      @ RED,78 SAY RPBEZ2 PICTURE "9999999.99"
      @ RED,89 SAY RPBEZ4 PICTURE "9999999.99"
      @ RED,100 SAY RUSP PICTURE "9999999.99"
      @ RED,111 SAY RUSBEZP PICTURE "9999999.99"
      @ RED,122 SAY RSVEP PICTURE "9999999.99"
      WRPV     = ROUND(WRPV    +   RPV,2)
      WRPN     = ROUND(WRPN    +   RPN,2)
      WRPBEZ   = ROUND(WRPBEZ  +   RPBEZ,2)
      WRPBEZ06 = ROUND(WRPBEZ06 +  RPBEZ06,2)
      WRPBEZ2  = ROUND(WRPBEZ2  +  RPBEZ2,2)
      WRPBEZ4  = ROUND(WRPBEZ4  +  RPBEZ4,2)
      WRUSP    = ROUND(WRUSP    +  RUSP,2)
      WRUSBEZP = ROUND(WRUSBEZP +  RUSBEZP,2)
      WRSVEP   = ROUND(WRSVEP   +  RSVEP,2)
      RED = RED + 1
          IF RED > 62
             RED = 0
             DO GLAVA
          ENDIF
 *  ELSE
 *       IF SK = "S"
 *       ELSE
 *       ENDIF
 *  ENDIF     && OD IF SK
   ENDIF
 SKIP
ENDDO
SET FILTER TO
RED = RED + 1
@ RED,0 SAY REPLI("*",133)
RED = RED + 1
@ RED,34 SAY wRPV PICTURE "9999999.99"
@ RED,45 SAY wRPN PICTURE "9999999.99"
@ RED,56 SAY wRPBEZ PICTURE "9999999.99"
@ RED,67 SAY wRPBEZ06 PICTURE "9999999.99"
@ RED,78 SAY wRPBEZ2 PICTURE "9999999.99"
@ RED,89 SAY wRPBEZ4 PICTURE "9999999.99"
@ RED,100 SAY wRUSP PICTURE "9999999.99"
@ RED,111 SAY wRUSBEZP PICTURE "9999999.99"
@ RED,122 SAY wRSVEP PICTURE "9999999.99"
@ red + 1,0 SAY " "
eject
SET CONSOLE ON
SET DEVICE TO SCREEN
set print off
set print to
CLEAR SCREEN
USE
RETURN
ENDDO
        
PROC GLAVA
STR = STR + 1
RED = RED + 2
@ RED,1 SAY gcNazRad
@ RED,35 SAY "STAMPANJE KNJIGE PRIHODA"
@ RED,70 SAY "STR:"
@ RED,76 SAY STR PICTURE "9999"
RED = RED + 1
@ RED,5 SAY "OD:"
@ RED,9 SAY DAT1
@ RED,66 SAY "DO:"
@ RED,70 SAY DAT2
RED = RED + 1
@ RED,0 SAY REPLI("*",133)
RED = RED + 1
@ RED,0 SAY "R.BR"
@ RED,5 SAY "DAT.KNJI"
@ RED,14 SAY "BROJ/RACUN"
@ RED,25 SAY "O  P I S"
@ RED,34 SAY "PRIHOD VIS"
@ RED,45 SAY "PRIHOD NIZ"
@ RED,56 SAY "PRIHOD BEZ"
@ RED,67 SAY "PRIHOD 0.6"
@ RED,78 SAY "PRIHOD 2 %"
@ RED,89 SAY "PRIHOD 4 %"
@ RED,100 SAY "PR.US.SA.P"
@ RED,111 SAY "P.US.BEZ P"
@ RED,122 SAY "PRI.UKUPNO"
RED = RED + 1
RETURN

